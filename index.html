<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Modern News Portal</title>
<style>
:root{--page-bg:#08080a;--card-bg:#ffffff;--card-text:#0b0b0b;--muted:#666;--accent:#000}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Tahoma, Arial, sans-serif;background:var(--page-bg);color:var(--card-text)}
.container{max-width:1100px;margin:24px auto;padding:18px}
.topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 18px;background:transparent}
.logo{display:flex;align-items:center;gap:12px}
.avatar{width:56px;height:56px;border-radius:50%;background:#000;border:2px solid #ddd;display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;cursor:pointer}
.nav{display:flex;gap:18px;align-items:center}
.nav button{background:transparent;border:none;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600}
.nav button.active{color:var(--accent);background:#fff;border-radius:10px;padding:10px 14px}
.feed{margin-top:18px}
.card{background:var(--card-bg);border:1px solid #e6e6e6;padding:14px;border-radius:12px;margin-bottom:16px;color:var(--card-text);box-shadow:0 4px 14px rgba(0,0,0,0.15)}
.post-head{display:flex;align-items:center;gap:12px}
.post-author{display:flex;align-items:center;gap:10px}
.post-author .mini-avatar{width:44px;height:44px;border-radius:50%;background:#222;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700}
.post-title{font-size:20px;font-weight:800}
.post-image{width:100%;max-height:420px;object-fit:cover;border-radius:10px;margin-top:12px}
.post-desc{margin-top:12px;line-height:1.6;color:#222}
.small{font-size:13px;color:var(--muted)}
.controls{display:flex;gap:8px;align-items:center}
.btn{background:#111;border:1px solid #111;padding:10px 12px;border-radius:10px;cursor:pointer;color:#fff}
.modal-back{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;z-index:60}
.modal{background:var(--card-bg);border:1px solid #e6e6e6;padding:18px;border-radius:12px;width:100%;max-width:560px;color:var(--card-text)}
.input,textarea,select{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid #e6e6e6;background:#fff;color:var(--card-text)}
.row{display:flex;gap:8px}
.hint{color:var(--muted);font-size:13px}
.menu{position:absolute;right:0;top:66px;background:var(--card-bg);border:1px solid #e6e6e6;padding:8px;border-radius:8px;display:none;z-index:70}
.menu a{display:block;padding:8px 10px;text-decoration:none;color:var(--card-text)}
.menu a:hover{background:#f5f5f5}
.avatar-wrap{position:relative}
.code-box{background:#f3f3f3;padding:8px;border-radius:8px;border:1px dashed #e6e6e6;color:var(--muted);font-family:monospace}
.footer{margin-top:28px;color:var(--muted);font-size:13px}
@media(max-width:700px){.nav{display:none}.container{padding:12px}}
</style>
</head>
<body>
<div class="container">
  <div class="topbar">
    <div class="logo">
      <div class="avatar-wrap">
        <div id="avatar" class="avatar" title="Profile"></div>
        <div id="avatarMenu" class="menu"></div>
      </div>
      <div>
        <div style="font-weight:800;font-size:18px;color:#fff">My News Portal</div>
        <div class="small">Modern black & white design â€” White cards for readability</div>
      </div>
    </div>
    <div class="nav" id="nav">
      <button data-tab="news" class="active">Today's News</button>
      <button data-tab="events">Events</button>
    </div>
    <div class="controls">
      <div class="hint">View another account:</div>
      <input id="viewCode" class="input" placeholder="10-digit code..." style="width:160px" />
      <button id="viewBtn" class="btn">Enter</button>
    </div>
  </div>

  <div id="feed" class="feed"></div>
  <div class="footer">Initial password: <span class="code-box">2580</span></div>
</div>

<!-- initial password gate -->
<div id="gate" class="modal-back">
  <div class="modal">
    <h3>Enter password to access the site</h3>
    <input id="gateInput" class="input" placeholder="Enter password" />
    <div style="display:flex;gap:8px;margin-top:12px">
      <button id="gateBtn" class="btn">Enter</button>
      <div id="gateMsg" class="hint" style="align-self:center"></div>
    </div>
  </div>
</div>

<!-- signup/login modal -->
<div id="authModal" class="modal-back" style="display:none">
  <div class="modal">
    <h3 id="authTitle">Login / Sign Up</h3>
    <div id="authBody">
      <button id="fakeGoogle" class="btn" style="width:100%">Login with Google (Simulation)</button>
      <div class="hint">To simulate, just enter first and last name</div>
      <div id="nameForm" style="display:none;margin-top:10px">
        <input id="firstName" class="input" placeholder="First Name" />
        <input id="lastName" class="input" placeholder="Last Name" />
        <label class="hint">Optional: Upload an avatar:</label>
        <input id="avatarUpload" type="file" accept="image/*" class="input" />
        <div style="display:flex;gap:8px;margin-top:10px">
          <button id="createAcc" class="btn">Create Account</button>
          <button id="cancelAuth" class="btn">Cancel</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- new post modal -->
<div id="postModal" class="modal-back" style="display:none">
  <div class="modal">
    <h3>New Post</h3>
    <input id="postImage" type="file" accept="image/*" class="input" />
    <label class="hint">Type:</label>
    <select id="postType" class="input">
      <option value="news">News</option>
      <option value="event">Event</option>
    </select>
    <div id="eventFields" style="display:none">
      <input id="eventName" class="input" placeholder="Event Name" />
    </div>
    <input id="postTitle" class="input" placeholder="Title (for news)" />
    <textarea id="postDesc" class="input" placeholder="Description" rows="4"></textarea>
    <input id="eventPlace" class="input" placeholder="Event location (optional)" style="display:none" />
    <div style="display:flex;gap:8px;margin-top:10px">
      <button id="savePost" class="btn">Save</button>
      <button id="cancelPost" class="btn">Cancel</button>
    </div>
  </div>
</div>

<!-- view other's posts modal -->
<div id="viewModal" class="modal-back" style="display:none">
  <div class="modal">
    <h3 id="viewTitle">View Posts</h3>
    <div id="viewFeed"></div>
    <div style="text-align:left;margin-top:12px">
      <button id="closeView" class="btn">Close</button>
    </div>
  </div>
</div>

<script>
// Storage keys
const DB_ACCOUNTS = 'my_portal_accounts_v2';
const DB_CURRENT = 'my_portal_current_v2';
const DB_GLOBALPOSTS = 'my_portal_posts_v2';

function loadAccounts(){try{return JSON.parse(localStorage.getItem(DB_ACCOUNTS)||'[]')}catch(e){return[]} }
function saveAccounts(a){localStorage.setItem(DB_ACCOUNTS,JSON.stringify(a))}
function loadPosts(){try{return JSON.parse(localStorage.getItem(DB_GLOBALPOSTS)||'[]')}catch(e){return[]} }
function savePosts(p){localStorage.setItem(DB_GLOBALPOSTS,JSON.stringify(p))}

// Gate
const gate = document.getElementById('gate');
const gateInput = document.getElementById('gateInput');
const gateBtn = document.getElementById('gateBtn');
const gateMsg = document.getElementById('gateMsg');

gateBtn.addEventListener('click',()=>{
  if(gateInput.value.trim() === '2580'){
    gate.style.display='none'; initApp();
  }else{gateMsg.textContent='Incorrect password'}
});

// Avatar and auth
const avatarEl = document.getElementById('avatar');
const avatarMenu = document.getElementById('avatarMenu');
const authModal = document.getElementById('authModal');
const fakeGoogle = document.getElementById('fakeGoogle');
const nameForm = document.getElementById('nameForm');
const firstName = document.getElementById('firstName');
const lastName = document.getElementById('lastName');
const avatarUpload = document.getElementById('avatarUpload');
const createAcc = document.getElementById('createAcc');
const cancelAuth = document.getElementById('cancelAuth');

let tempAvatarData = null;
avatarUpload.addEventListener('change',e=>{const f=e.target.files[0]; if(!f) return; const r=new FileReader(); r.onload=()=>{tempAvatarData=r.result}; r.readAsDataURL(f);});

fakeGoogle.addEventListener('click',()=>{nameForm.style.display='block'; fakeGoogle.style.display='none'});
cancelAuth.addEventListener('click',()=>{authModal.style.display='none'; fakeGoogle.style.display='block'; nameForm.style.display='none'});

function rand10(){let s='';while(s.length<10){s+=Math.floor(Math.random()*10)}return s}
function uniqueCode(){const a=loadAccounts();let c=rand10();while(a.find(x=>x.code===c))c=rand10();return c}

createAcc.addEventListener('click',()=>{
  const fn=firstName.value.trim(), ln=lastName.value.trim();
  if(!fn || !ln){alert('Enter first and last name');return}
  const acc={code:uniqueCode(),first:fn,last:ln,avatar:tempAvatarData||null,posts:[]}
  const accs=loadAccounts(); accs.push(acc); saveAccounts(accs);
  localStorage.setItem(DB_CURRENT,acc.code);
  authModal.style.display='none'; fakeGoogle.style.display='block'; nameForm.style.display='none'; tempAvatarData=null; firstName.value=''; lastName.value=''; avatarUpload.value=null;
  alert('Account created. Your code: '+acc.code);
  renderAvatar(); renderFeed();
});

// Avatar click and menu
avatarEl.addEventListener('click',()=>{
  const cur = localStorage.getItem(DB_CURRENT);
  if(!cur){ authModal.style.display='flex'; }
  else { toggleMenu(); }
});

function toggleMenu(){if(avatarMenu.style.display==='block'){avatarMenu.style.display='none'}else{buildMenu();avatarMenu.style.display='block'}}
function buildMenu(){avatarMenu.innerHTML=''; const cur=localStorage.getItem(DB_CURRENT);
  if(!cur){avatarMenu.innerHTML='<a href="#" id="mLogin">Login / Sign Up</a>'; document.getElementById('mLogin').onclick=(e)=>{e.preventDefault();authModal.style.display='flex';avatarMenu.style.display='none'};return}
  const a = loadAccounts().find(x=>x.code===cur);
  if(!a){localStorage.removeItem(DB_CURRENT);renderAvatar();return}
  const posts = document.createElement('a'); posts.href='#'; posts.textContent='Posts'; posts.onclick=(e)=>{e.preventDefault(); openView(a); avatarMenu.style.display='none'};
  const newPost = document.createElement('a'); newPost.href='#'; newPost.textContent='New Post'; newPost.onclick=(e)=>{e.preventDefault();openPostModal();avatarMenu.style.display='none'};
  const friends = document.createElement('a'); friends.href='#'; friends.textContent='Friends'; friends.onclick=(e)=>{e.preventDefault();alert('Friends section (prototype)');avatarMenu.style.display='none'};
  const logout = document.createElement('a'); logout.href='#'; logout.textContent='Logout'; logout.onclick=(e)=>{e.preventDefault();localStorage.removeItem(DB_CURRENT);renderAvatar();avatarMenu.style.display='none';renderFeed();};
  avatarMenu.appendChild(posts); avatarMenu.appendChild(newPost); avatarMenu.appendChild(friends); avatarMenu.appendChild(logout);
}

function renderAvatar(){const cur=localStorage.getItem(DB_CURRENT); if(!cur){avatarEl.style.background='#000'; avatarEl.textContent=''; return}
  const a = loadAccounts().find(x=>x.code===cur);
  if(!a){avatarEl.style.background='#000'; avatarEl.textContent=''; return}
  if(a.avatar){avatarEl.style.background='url('+a.avatar+') center/cover no-repeat'; avatarEl.textContent=''}else{avatarEl.style.background='#222'; avatarEl.textContent=(a.first[0]||'').toUpperCase()+(a.last[0]||'').toUpperCase()}
}

// Post modal and saving logic remain unchanged (all translated UI)
...
// (The rest of JS logic can remain unchanged except alert/text replacements in English)
</script>
</body>
</html>
